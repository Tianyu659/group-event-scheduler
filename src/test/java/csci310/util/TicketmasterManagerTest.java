package csci310.util;

import java.io.IOException;
import java.util.HashMap;
import java.util.Map;

import com.fasterxml.jackson.core.type.TypeReference;
import com.fasterxml.jackson.databind.ObjectMapper;
import org.junit.Assert;
import org.junit.Test;

public class TicketmasterManagerTest extends TicketmasterManager{
	@Test
	public void testsearchEventByKeyword() throws IOException {
		String keyword = "eventnotfound";

		ObjectMapper objectMapper = new ObjectMapper();
		TypeReference<HashMap<String, Object>> typeRef = new TypeReference<>() {};
		Map<String, Object> map = objectMapper.readValue(TicketmasterManager.searchEventByKeyword(keyword), typeRef);

		Assert.assertNotNull(map.get("_links"));
		Assert.assertNotNull(map.get("page"));

	}
	
	//Need change after event model is done
	@Test
	public void testgetEventDetails() throws IOException {
		String eventID = "k7vGFpS8LxPSc";
		String expected = "{\"name\":\"Mozart & Mendelssohn\",\"type\":\"event\",\"id\":\"k7vGFpS8LxPSc\",\"test\":false,\"url\":\"https://www.ticketmaster.com/mozart-mendelssohn-newark-new-jersey-06-02-2022/event/00005B341F8A5CED\",\"locale\":\"en-us\",\"images\":[{\"ratio\":\"3_2\",\"url\":\"https://s1.ticketm.net/dam/a/f14/ca27b688-79ef-4376-8582-4bef0f0d8f14_302061_TABLET_LANDSCAPE_3_2.jpg\",\"width\":1024,\"height\":683,\"fallback\":false},{\"ratio\":\"16_9\",\"url\":\"https://s1.ticketm.net/dbimages/408060a.jpg\",\"width\":205,\"height\":115,\"fallback\":false},{\"ratio\":\"4_3\",\"url\":\"https://s1.ticketm.net/dam/a/f14/ca27b688-79ef-4376-8582-4bef0f0d8f14_302061_CUSTOM.jpg\",\"width\":305,\"height\":225,\"fallback\":false},{\"ratio\":\"16_9\",\"url\":\"https://s1.ticketm.net/dam/a/f14/ca27b688-79ef-4376-8582-4bef0f0d8f14_302061_RETINA_LANDSCAPE_16_9.jpg\",\"width\":1136,\"height\":639,\"fallback\":false},{\"ratio\":\"3_2\",\"url\":\"https://s1.ticketm.net/dam/a/f14/ca27b688-79ef-4376-8582-4bef0f0d8f14_302061_ARTIST_PAGE_3_2.jpg\",\"width\":305,\"height\":203,\"fallback\":false},{\"ratio\":\"16_9\",\"url\":\"https://s1.ticketm.net/dam/a/f14/ca27b688-79ef-4376-8582-4bef0f0d8f14_302061_TABLET_LANDSCAPE_16_9.jpg\",\"width\":1024,\"height\":576,\"fallback\":false},{\"ratio\":\"16_9\",\"url\":\"https://s1.ticketm.net/dam/a/f14/ca27b688-79ef-4376-8582-4bef0f0d8f14_302061_RETINA_PORTRAIT_16_9.jpg\",\"width\":640,\"height\":360,\"fallback\":false},{\"ratio\":\"16_9\",\"url\":\"https://s1.ticketm.net/dam/a/f14/ca27b688-79ef-4376-8582-4bef0f0d8f14_302061_RECOMENDATION_16_9.jpg\",\"width\":100,\"height\":56,\"fallback\":false},{\"ratio\":\"3_2\",\"url\":\"https://s1.ticketm.net/dam/a/f14/ca27b688-79ef-4376-8582-4bef0f0d8f14_302061_RETINA_PORTRAIT_3_2.jpg\",\"width\":640,\"height\":427,\"fallback\":false},{\"ratio\":\"16_9\",\"url\":\"https://s1.ticketm.net/dam/a/f14/ca27b688-79ef-4376-8582-4bef0f0d8f14_302061_TABLET_LANDSCAPE_LARGE_16_9.jpg\",\"width\":2048,\"height\":1152,\"fallback\":false}],\"sales\":{\"public\":{\"startDateTime\":\"2021-09-24T14:00:00Z\",\"startTBD\":false,\"startTBA\":false,\"endDateTime\":\"2022-06-02T17:30:00Z\"}},\"dates\":{\"start\":{\"localDate\":\"2022-06-02\",\"localTime\":\"13:30:00\",\"dateTime\":\"2022-06-02T17:30:00Z\",\"dateTBD\":false,\"dateTBA\":false,\"timeTBA\":false,\"noSpecificTime\":false},\"timezone\":\"America/New_York\",\"status\":{\"code\":\"onsale\"},\"spanMultipleDays\":false},\"classifications\":[{\"primary\":true,\"segment\":{\"id\":\"KZFzniwnSyZfZ7v7na\",\"name\":\"Arts & Theatre\"},\"genre\":{\"id\":\"KnvZfZ7v7nJ\",\"name\":\"Classical\"},\"subGenre\":{\"id\":\"KZazBEonSMnZfZ7v7nI\",\"name\":\"Symphonic\"},\"type\":{\"id\":\"KZAyXgnZfZ7v7nI\",\"name\":\"Undefined\"},\"subType\":{\"id\":\"KZFzBErXgnZfZ7v7lJ\",\"name\":\"Undefined\"},\"family\":false}],\"promoter\":{\"id\":\"494\",\"name\":\"PROMOTED BY VENUE\",\"description\":\"PROMOTED BY VENUE / NTL / USA\"},\"promoters\":[{\"id\":\"494\",\"name\":\"PROMOTED BY VENUE\",\"description\":\"PROMOTED BY VENUE / NTL / USA\"}],\"info\":\"The NJSO's Brennan Sweet and Elzbieta Weyman play some of the loveliest music ever written for violin and viola, Mozart's Sinfonia Concertante. Kathleen Nester makes the orchestra's tiniest instrument sing loud and proud in Vivaldi's Piccolo Concerto. The sunshine of Mendelssohn's \\\"Italian\\\" Symphony warms the entire program. ROSSINI Overture to L'italiana in Algeri MOZART Sinfonia Concertante for Violin and Viola VIVALDI Piccolo Concerto in C Major MENDELSSOHN Symphony No. 4, \\\"Italian\\\" XIAN ZHANG conductor BRENNAN SWEET violin ELZBIETA WEYMAN viola KATHLEEN NESTER piccolo NEW JERSEY SYMPHONY ORCHESTRA\",\"pleaseNote\":\"By purchasing a ticket for an event at NJPAC, you and any of your guests voluntarily assume all risks related to exposure to COVID-19, whether known or unknown, and hereby release and waive any claims against NJPAC and its parent companies, subsidiaries, affiliates, holding companies, divisions, licensees, sureties, insurers, advertising and promotional agencies, any other related entities, and their respective directors, officers, managers, members, employees, representatives and agents, and all of their respective successors and assigns from any and all claims, demands, actions, suits, proceedings, costs, expenses, damages, and liabilities, including without limitation reasonable attorney's fees and costs, arising out of, in connection with, resulting from, or related to your access to NJPAC's premises and any claim related in whole or in part to illness, death, disability, personal injury, property damage or any other claim for damages or other relief.\",\"priceRanges\":[{\"type\":\"standard\",\"currency\":\"USD\",\"min\":25.0,\"max\":90.0}],\"products\":[{\"name\":\"PARKWHIZ NEW JERSEY PERFORMING ARTS CENTER\",\"id\":\"k7vGFpSmY8KUo\",\"url\":\"https://www.ticketmaster.com/parkwhiz-new-jersey-performing-arts-center-newark-new-jersey-06-02-2022/event/00005B3BB0413D91\",\"type\":\"Upsell\",\"classifications\":[{\"primary\":true,\"segment\":{\"id\":\"KZFzniwnSyZfZ7v7n1\",\"name\":\"Miscellaneous\"},\"genre\":{\"id\":\"KnvZfZ7v7ll\",\"name\":\"Undefined\"},\"subGenre\":{\"id\":\"KZazBEonSMnZfZ7vAv1\",\"name\":\"Undefined\"},\"type\":{\"id\":\"KZAyXgnZfZ7vAva\",\"name\":\"Parking\"},\"subType\":{\"id\":\"KZFzBErXgnZfZ7vAFe\",\"name\":\"Parking\"},\"family\":false}]}],\"seatmap\":{\"staticUrl\":\"https://maps.ticketmaster.com/maps/geometry/3/event/00005B341F8A5CED/staticImage?type=png&systemId=HOST\"},\"accessibility\":{\"info\":\"ADA and ADA Companion seating is available throughout the venue.  Please use the dropdown above to select the desired seat types.\",\"ticketLimit\":4},\"ticketLimit\":{\"info\":\"There is an overall 8 ticket limit for this event.\"},\"ageRestrictions\":{\"legalAgeEnforced\":false},\"_links\":{\"self\":{\"href\":\"/discovery/v2/events/k7vGFpS8LxPSc?locale=en-us\"},\"attractions\":[{\"href\":\"/discovery/v2/attractions/K8vZ91719tV?locale=en-us\"},{\"href\":\"/discovery/v2/attractions/K8vZ9173Yd0?locale=en-us\"}],\"venues\":[{\"href\":\"/discovery/v2/venues/KovZpa6Vxe?locale=en-us\"}]},\"_embedded\":{\"venues\":[{\"name\":\"New Jersey Performing Arts Center\",\"type\":\"venue\",\"id\":\"KovZpa6Vxe\",\"test\":false,\"url\":\"https://www.ticketmaster.com/new-jersey-performing-arts-center-tickets-newark/venue/308\",\"locale\":\"en-us\",\"aliases\":[\"njpac\",\"new jersey performing arts center\"],\"images\":[{\"ratio\":\"16_9\",\"url\":\"https://s1.ticketm.net/dbimages/19782v.jpg\",\"width\":205,\"height\":115,\"fallback\":false},{\"ratio\":\"3_1\",\"url\":\"https://s1.ticketm.net/dam/v/5ab/7ec9eb74-d8e2-403d-a281-067bd2adf5ab_529351_SOURCE.jpg\",\"width\":1500,\"height\":500,\"fallback\":false}],\"postalCode\":\"07102\",\"timezone\":\"America/New_York\",\"city\":{\"name\":\"Newark\"},\"state\":{\"name\":\"New Jersey\",\"stateCode\":\"NJ\"},\"country\":{\"name\":\"United States Of America\",\"countryCode\":\"US\"},\"address\":{\"line1\":\"1 Center Street\"},\"location\":{\"longitude\":\"-74.16809\",\"latitude\":\"40.739502\"},\"markets\":[{\"name\":\"New York/Tri-State Area\",\"id\":\"35\"},{\"name\":\"Northern New Jersey\",\"id\":\"55\"},{\"name\":\"Connecticut\",\"id\":\"124\"}],\"dmas\":[{\"id\":296},{\"id\":345},{\"id\":422}],\"social\":{\"twitter\":{\"handle\":\"@NJPAC\"}},\"boxOfficeInfo\":{\"phoneNumberDetail\":\"General Box Office: 1-888-466-5722 Web sites: NJPAC http://www.njpac.org\",\"openHoursDetail\":\"NJPAC Box Office is open for limited summer hours. Visit njpac.org/visit/box-office/ for details Box office hours beginning Sept 7, 2021 Monday: Closed Tuesday - Friday: 12 - 6pm Saturday: 12 - 4pm Sunday: Closed Box Office opens three hours before curtain time when performances are scheduled on Sunday or Monday. Box office remains open on performance evenings until end of first intermission or 30 minutes after the start of a performance when there is no intermission.\",\"acceptedPaymentDetail\":\"Cash, Visa, MasterCard, Discover, American Express\",\"willCallDetail\":\"Will call is located at the box office. Will call is open whenever the box office is open. (When VIP package tickets are offered, these may available at will call only on the day of the performance.)\"},\"parkingDetail\":\"Parking is available in two secure surface lots and the Military Park garage, all located across the street from or adjacent to NJPAC. The cost varies by performance, from $15 to $28 day of the performance. Discounted parking -- $1 off day of the performance rate -- may be purchased up to the day before the performance when ordering tickets or by visiting the parking page at njpac.org/parking\",\"accessibleSeatingDetail\":\"1-973-297-5843 Monday through Friday, 9am to 5pm. Please leave a voice message should no one answer immediately. NJPAC is accessible to persons with disabilities. Persons with disabilities are advised to contact NJPAC Ticket Services at the number above before making their ticket purchase online or via 1-888-GO-NJAC (1-888-466-5722). Ticket Services staff are prepared with assisting them with seating. Persons with hearing disabilities should call NJ Telephone Relay Services at 711 for assistance with connecting with our ticket services staff. - Registered service animals assisting persons with disabilities are permitted in the theater. - Sennheiser listening (FM and infra-red) devices are available in the lobby of the theater. An usher can assist patrons who require these devices. Patrons will be asked to leave a driver's license or credit card as collateral.\",\"generalInfo\":{\"generalRule\":\"Cameras and audio recording devices are not permitted in the theater. The taking of video and pictures, especially flash photos, is disruptive and inconsiderate to both the artist and other members of the audience. Just as importantly, the visual and audio performances of the artist are protected under both US and international copyright laws. NJPAC has the right to confiscate all recording devices. All bags are subject to search. Backpacks, suitcases, bags and women’s purses larger than 12” x 12” x 8” may not be taken into the theaters. Patrons carrying larger bags will be asked to bring them to the coat check at no charge and will be given a plastic bag for carrying select items, such as wallets and cell phones, into the theater. An exception will be made for medically necessary items after proper inspection. NJPAC reserves the right to inspect and search persons entering NJPAC property and hand-carried items. Violators of this policy may be subject to ejection from NJPAC property and/or civil or criminal penalties.\",\"childRule\":\"NJPAC recommends that children younger than 5 years of age not attend adult performances. Both NJPAC and the NJSO have programs specifically designed for young children. Please call each organization for information. All persons entering the theater, including babes in arms, must have a ticket. Any child under the age of 14 must be accompanied by an adult.\"},\"upcomingEvents\":{\"_total\":108,\"ticketmaster\":108},\"ada\":{\"adaPhones\":\"Customer Service: 1-973-297-5843 Monday through Friday, 9am to 5pm.\\n\\nWeb sites:  \\nNJPAC   http://www.njpac.org    \",\"adaCustomCopy\":\"To better accommodate your needs, New Jersey Performing Arts Center has requested that all special seating accommodations be solicited only through their representatives. Please contact a New Jersey Performing Arts Center representative for further help with your ticket purchase.*   Advance ticket purchase may be required.\\n\\n* Box office information is subject to change.\",\"adaHours\":\"The NJPAC Box Office is closed during the COVID-19 pandemic.  Please call the Customer Service number above.  Please leave a voice message should no one answer immediately. Your call will be returned no later than the end of the next business day. \"},\"_links\":{\"self\":{\"href\":\"/discovery/v2/venues/KovZpa6Vxe?locale=en-us\"}}}],\"attractions\":[{\"name\":\"New Jersey Symphony Orchestra\",\"type\":\"attraction\",\"id\":\"K8vZ91719tV\",\"test\":false,\"url\":\"https://www.ticketmaster.com/new-jersey-symphony-orchestra-tickets/artist/804110\",\"locale\":\"en-us\",\"images\":[{\"ratio\":\"3_2\",\"url\":\"https://s1.ticketm.net/dam/a/f14/ca27b688-79ef-4376-8582-4bef0f0d8f14_302061_TABLET_LANDSCAPE_3_2.jpg\",\"width\":1024,\"height\":683,\"fallback\":false},{\"ratio\":\"4_3\",\"url\":\"https://s1.ticketm.net/dam/a/f14/ca27b688-79ef-4376-8582-4bef0f0d8f14_302061_CUSTOM.jpg\",\"width\":305,\"height\":225,\"fallback\":false},{\"ratio\":\"16_9\",\"url\":\"https://s1.ticketm.net/dam/a/f14/ca27b688-79ef-4376-8582-4bef0f0d8f14_302061_EVENT_DETAIL_PAGE_16_9.jpg\",\"width\":205,\"height\":115,\"fallback\":false},{\"ratio\":\"16_9\",\"url\":\"https://s1.ticketm.net/dam/a/f14/ca27b688-79ef-4376-8582-4bef0f0d8f14_302061_RETINA_LANDSCAPE_16_9.jpg\",\"width\":1136,\"height\":639,\"fallback\":false},{\"ratio\":\"3_2\",\"url\":\"https://s1.ticketm.net/dam/a/f14/ca27b688-79ef-4376-8582-4bef0f0d8f14_302061_ARTIST_PAGE_3_2.jpg\",\"width\":305,\"height\":203,\"fallback\":false},{\"ratio\":\"16_9\",\"url\":\"https://s1.ticketm.net/dam/a/f14/ca27b688-79ef-4376-8582-4bef0f0d8f14_302061_TABLET_LANDSCAPE_16_9.jpg\",\"width\":1024,\"height\":576,\"fallback\":false},{\"ratio\":\"16_9\",\"url\":\"https://s1.ticketm.net/dam/a/f14/ca27b688-79ef-4376-8582-4bef0f0d8f14_302061_RETINA_PORTRAIT_16_9.jpg\",\"width\":640,\"height\":360,\"fallback\":false},{\"ratio\":\"16_9\",\"url\":\"https://s1.ticketm.net/dam/a/f14/ca27b688-79ef-4376-8582-4bef0f0d8f14_302061_RECOMENDATION_16_9.jpg\",\"width\":100,\"height\":56,\"fallback\":false},{\"ratio\":\"3_2\",\"url\":\"https://s1.ticketm.net/dam/a/f14/ca27b688-79ef-4376-8582-4bef0f0d8f14_302061_RETINA_PORTRAIT_3_2.jpg\",\"width\":640,\"height\":427,\"fallback\":false},{\"ratio\":\"16_9\",\"url\":\"https://s1.ticketm.net/dam/a/f14/ca27b688-79ef-4376-8582-4bef0f0d8f14_302061_TABLET_LANDSCAPE_LARGE_16_9.jpg\",\"width\":2048,\"height\":1152,\"fallback\":false}],\"classifications\":[{\"primary\":true,\"segment\":{\"id\":\"KZFzniwnSyZfZ7v7na\",\"name\":\"Arts & Theatre\"},\"genre\":{\"id\":\"KnvZfZ7v7nJ\",\"name\":\"Classical\"},\"subGenre\":{\"id\":\"KZazBEonSMnZfZ7v7nI\",\"name\":\"Symphonic\"},\"type\":{\"id\":\"KZAyXgnZfZ7v7nI\",\"name\":\"Undefined\"},\"subType\":{\"id\":\"KZFzBErXgnZfZ7v7lJ\",\"name\":\"Undefined\"},\"family\":false}],\"upcomingEvents\":{\"_total\":21,\"ticketmaster\":21},\"_links\":{\"self\":{\"href\":\"/discovery/v2/attractions/K8vZ91719tV?locale=en-us\"}}},{\"name\":\"Xian Zhang\",\"type\":\"attraction\",\"id\":\"K8vZ9173Yd0\",\"test\":false,\"url\":\"https://www.ticketmaster.com/xian-zhang-tickets/artist/2026607\",\"locale\":\"en-us\",\"images\":[{\"ratio\":\"16_9\",\"url\":\"https://s1.ticketm.net/dam/c/f7b/ef64d601-8740-43cd-86ea-ed9b392e4f7b_105961_EVENT_DETAIL_PAGE_16_9.jpg\",\"width\":205,\"height\":115,\"fallback\":true},{\"ratio\":\"3_2\",\"url\":\"https://s1.ticketm.net/dam/c/f7b/ef64d601-8740-43cd-86ea-ed9b392e4f7b_105961_TABLET_LANDSCAPE_3_2.jpg\",\"width\":1024,\"height\":683,\"fallback\":true},{\"ratio\":\"3_2\",\"url\":\"https://s1.ticketm.net/dam/c/f7b/ef64d601-8740-43cd-86ea-ed9b392e4f7b_105961_ARTIST_PAGE_3_2.jpg\",\"width\":305,\"height\":203,\"fallback\":true},{\"ratio\":\"4_3\",\"url\":\"https://s1.ticketm.net/dam/c/f7b/ef64d601-8740-43cd-86ea-ed9b392e4f7b_105961_CUSTOM.jpg\",\"width\":305,\"height\":225,\"fallback\":true},{\"ratio\":\"3_2\",\"url\":\"https://s1.ticketm.net/dam/c/f7b/ef64d601-8740-43cd-86ea-ed9b392e4f7b_105961_RETINA_PORTRAIT_3_2.jpg\",\"width\":640,\"height\":427,\"fallback\":true},{\"ratio\":\"16_9\",\"url\":\"https://s1.ticketm.net/dam/c/f7b/ef64d601-8740-43cd-86ea-ed9b392e4f7b_105961_TABLET_LANDSCAPE_LARGE_16_9.jpg\",\"width\":2048,\"height\":1152,\"fallback\":true},{\"ratio\":\"16_9\",\"url\":\"https://s1.ticketm.net/dam/c/f7b/ef64d601-8740-43cd-86ea-ed9b392e4f7b_105961_RETINA_PORTRAIT_16_9.jpg\",\"width\":640,\"height\":360,\"fallback\":true},{\"ratio\":\"16_9\",\"url\":\"https://s1.ticketm.net/dam/c/f7b/ef64d601-8740-43cd-86ea-ed9b392e4f7b_105961_RECOMENDATION_16_9.jpg\",\"width\":100,\"height\":56,\"fallback\":true},{\"ratio\":\"16_9\",\"url\":\"https://s1.ticketm.net/dam/c/f7b/ef64d601-8740-43cd-86ea-ed9b392e4f7b_105961_TABLET_LANDSCAPE_16_9.jpg\",\"width\":1024,\"height\":576,\"fallback\":true},{\"ratio\":\"16_9\",\"url\":\"https://s1.ticketm.net/dam/c/f7b/ef64d601-8740-43cd-86ea-ed9b392e4f7b_105961_RETINA_LANDSCAPE_16_9.jpg\",\"width\":1136,\"height\":639,\"fallback\":true}],\"classifications\":[{\"primary\":true,\"segment\":{\"id\":\"KZFzniwnSyZfZ7v7na\",\"name\":\"Arts & Theatre\"},\"genre\":{\"id\":\"KnvZfZ7v7nJ\",\"name\":\"Classical\"},\"subGenre\":{\"id\":\"KZazBEonSMnZfZ7v7nI\",\"name\":\"Symphonic\"},\"type\":{\"id\":\"KZAyXgnZfZ7v7nI\",\"name\":\"Undefined\"},\"subType\":{\"id\":\"KZFzBErXgnZfZ7v7lJ\",\"name\":\"Undefined\"},\"family\":false}],\"upcomingEvents\":{\"_total\":13,\"ticketmaster\":13},\"_links\":{\"self\":{\"href\":\"/discovery/v2/attractions/K8vZ9173Yd0?locale=en-us\"}}}]}}";

		ObjectMapper objectMapper = new ObjectMapper();
		TypeReference<HashMap<String, Object>> typeRef = new TypeReference<>() {};
		Map<String, Object> map = objectMapper.readValue(TicketmasterManager.getEventDetails(eventID), typeRef);

		Assert.assertEquals(map.get("name"), "Mozart & Mendelssohn");
		Assert.assertEquals(map.get("type"), "event");
	}
}
